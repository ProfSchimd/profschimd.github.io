<!doctype html><html><head><meta charset=utf-8><title>Sincronizzazione &ndash; Michele Schimd
</title><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://cdn.jsdelivr.net/npm/bootswatch@4.5.2/dist/spacelab/bootstrap.min.css rel=stylesheet><link href=https://profschimd.github.io/css/syntax.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css><script src=https://code.jquery.com/jquery-3.4.1.slim.min.js integrity=sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n crossorigin=anonymous></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body class="d-flex flex-column min-vh-100"><header><nav class="p-1 navbar navbar-expand-lg navbar-dark bg-primary"><div class=container><a class=navbar-brand rel=author href=https://profschimd.github.io/>Michele Schimd</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false>Materie</a><ul class=dropdown-menu aria-labelledby=navbarDropdown><li><a href=https://profschimd.github.io/materie/inf/ class=dropdown-item>Informatica</a></li><li><a href=https://profschimd.github.io/materie/sr/ class=dropdown-item>SR</a></li><li><a href=https://profschimd.github.io/materie/tpsit/ class=dropdown-item>TPSIT</a></li><li><a href=https://profschimd.github.io/materie/gpoi/ class=dropdown-item>GPOI</a></li><li><a href=https://profschimd.github.io/materie/ec/ class=dropdown-item>EC</a></li><li><a href=https://profschimd.github.io/materie/python/ class=dropdown-item>Python</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false>Classi</a><ul class=dropdown-menu aria-labelledby=navbarDropdown><li><a href=https://profschimd.github.io/classi/3ic/ class=dropdown-item>3IC</a></li><li><a href=https://profschimd.github.io/classi/4ic/ class=dropdown-item>4IC</a></li><li><a href=https://profschimd.github.io/classi/4ia/ class=dropdown-item>5IA</a></li><li><a href=https://profschimd.github.io/classi/5ic/ class=dropdown-item>5IC</a></li><li><a href=https://profschimd.github.io/classi/anni-passati/ class=dropdown-item>Anni precedenti</a></li></ul></li><li class=nav-item><a class=nav-link href=https://profschimd.github.io/about/ role=button><i class="bi bi-info-circle"></i></a></li></ul></div></div></nav></header><div class="p-4 bg-primary" style="background-size:cover;background-position:50%;background-image:linear-gradient(to bottom,rgba(0,0,0,.3) 0%,rgba(0,0,0,.6) 100%),url(https://profschimd.github.io/img/zuccante_it.jpeg)"><div class=container><h1 class="display-4 text-white">Sincronizzazione</h1></div></div><div class=bg-light><nav aria-label="breadcrumb mt-0"><div class=container><ol class="breadcrumb py-0 my-1 small"><li class=breadcrumb-item><a href=https://profschimd.github.io/>Home</a></li><li class=breadcrumb-item><a href=https://profschimd.github.io/materie/>Materie</a></li><li class=breadcrumb-item><a href=https://profschimd.github.io/materie/tpsit/>TPSIT</a></li><li class=breadcrumb-item><a href=https://profschimd.github.io/materie/tpsit/4/>Quarto Anno</a></li><li class=breadcrumb-item><a href=https://profschimd.github.io/materie/tpsit/4/02-sincronizzazione/>Sincronizzazione</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://profschimd.github.io/materie/tpsit/4/02-sincronizzazione/sincronizzazione/>Sincronizzazione</a></li></ol></nav></div><div class="container py-5"><main><div class=row><div class=col-10><aside><nav id=TableOfContents><ul><li><a href=#cosè-la-sincronizzazione>Cos&rsquo;è la sincronizzazione</a></li><li><a href=#thread-join>Thread join</a><ul><li><a href=#sequence-diagram-per-il-join-di-due-thread><em>Sequence diagram</em> per il join di due thread</a></li></ul></li><li><a href=#race-condition>Race condition</a><ul><li><a href=#esempio-di-race-condition-data-race>Esempio di race condition (data race)</a></li></ul></li></ul></nav></aside></div><div class=col-2></div></div><article><div class=container style=text-align:justify><h2 id=cosè-la-sincronizzazione>Cos&rsquo;è la sincronizzazione</h2><p>Vari tipi di problemi hanno soluzioni le cui operazioni devono essere fatte in un ordine ben preciso. Ad esempio, quando si cucina una pizza, si deve <em>aspettare</em> che il forno sia caldo prima che si possa inserire la pizza cruda. Inoltre, gli ingredienti devono essere messi <em>prima</em> di infornare la pizza altrimenti questi non si cuociono.</p><p>Anche nei problemi informatici è spesso necessario che le operazioni si svolgano in una sequenza ben precisa, questa sequenza di operazione prende il nome di <em>algoritmo</em>. Ma cosa succede quando le operazioni sono svolte contemporaneamente, ad esempio quando due thread eseguono su due core diversi? Se alcune operazioni in un thread devono essere eseguite <em>dopo</em> che alcune operazioni del secondo thread sono state eseguite, allora i due thread devono <strong>sincronizzarsi</strong>. Se riprendiamo l&rsquo;esempio della pizza, è possibile che, per velocizzare il servizio, un ristornate abbia due persone che lavorano al banco delle pizze: uno guarnisce, l&rsquo;altro inforna. Ovviamente vogliamo che chi inforna lo faccia solo dopo che la pizza è guarnita. In questo la sincronizzazione avviene tra le due persone. Probabilmente la persona che guarnisce comunica a quella che inforna quali pizze sono pronte per il essere cucinate.</p><div class=row><div class=col-6><p><svg style="float:left;margin:30px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="322" height="221" viewBox="-.5 -.5 322 221"><defs/><g><rect x="40" y="0" width="100" height="40" fill="#fff" stroke="#000" pointer-events="all"/><path d="M90 40V220" fill="none" stroke="#000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g fill="#000" font-family="Helvetica" text-anchor="middle" font-size="12"><text x="89.5" y="24.5">:Guarnire</text></g><rect x="85" y="70" width="10" height="50" fill="#fff" stroke="#000" pointer-events="all"/><path d="M14 70H76.88" fill="none" stroke="#000" stroke-miterlimit="10" pointer-events="stroke"/><ellipse cx="10" cy="70" rx="4" ry="4" fill="#000" stroke="#000" pointer-events="all"/><path d="M83.88 70l-7 3.5v-7z" fill="#000" stroke="#000" stroke-miterlimit="10" pointer-events="all"/><g fill="#000" font-family="Helvetica" text-anchor="middle" font-size="11"><rect fill="#fff" stroke="none" x="18" y="55" width="61" height="14" stroke-width="0"/><text x="47.15" y="64.5">ordine pizza</text></g><rect x="85" y="170" width="10" height="30" fill="#fff" stroke="#000" pointer-events="all"/><rect x="220" y="0" width="100" height="40" fill="#fff" stroke="#000" pointer-events="all"/><path d="M270 40V220" fill="none" stroke="#000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g fill="#000" font-family="Helvetica" text-anchor="middle" font-size="12"><text x="269.5" y="24.5">:Infornare</text></g><rect x="265" y="120" width="10" height="50" fill="#fff" stroke="#000" pointer-events="all"/><path d="M95 120H256.88" fill="none" stroke="#000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M263.88 120l-7 3.5v-7z" fill="#000" stroke="#000" stroke-miterlimit="10" pointer-events="all"/><g fill="#000" font-family="Helvetica" text-anchor="middle" font-size="11"><rect fill="#fff" stroke="none" x="137" y="105" width="88" height="14" stroke-width="0"/><text x="179.79" y="114.5">pronta per il forno</text></g><path d="M270.23 169.7 92.94 169.26" fill="none" stroke="#000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M100.83 164.78 91.82 169.25 100.81 173.78" fill="none" stroke="#000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 166px; margin-left: 180px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">pizza cotta</div></div></div></foreignObject><text x="180" y="166" fill="#000" font-family="Helvetica" font-size="11" text-anchor="middle">pizza cotta</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg></p></div><div class=col-6>Nella figura a sinistra si vede il <b>diagramma di sequenza</b> (<em>sequence diagram</em>) per le operazioni di farcitura e cottura di una pizza. Le operazioni iniziano con la guarnizione degli ingredienti dopo che arriva l&rsquo;ordine. Al termine di una prima farcitura, la pizza e pronta per il forno e viene quindi &ldquo;passata&rdquo; alla fase di cottura dalla quale esce una volta cotta per una seconda farcitura con gli ingredienti da mettere &ldquo;a fine cottura&rdquo;.</div></div><div class="alert alert-primary" markdown=1><h5 class=no_toc><i class="bi bi-pencil-square"></i> Esercizio</strong></h5><p>Quali operazioni operazioni compi durante la tua giornata che richiedono una sincronizzazione con altre persone? Fai il sequence diagram per una o più di queste.</p></div><p>Ci si potrebbe chiedere se la sincronizzazione tra thread sia veramente necessaria, in effetti è possibile che alcuni problemi si possano risolvere utilizzando thread che non devono mai sincronizzarsi. Tuttavia, è più comune che un programma multithreading necessiti di sincronizzazione tra i suoi thread. Normalmente la sincronizzazione serve per evitare che il programma si comporti in modo anomalo. Ad esempio, se un thread si occupa di scaricare i fotogrammi di un video ed un altro thread si occupa di mostrare il video, il secondo thread dovrà attendere l&rsquo;arrivo dei fotogrammi prima di metterli in sequenza per formare il video. In pratica la sincronizzazione è necessaria quando una operazione OP1 di un thread TA può essere eseguita solo dopo che l&rsquo;operazione OP2 del thread TB è stata eseguita. Dal momento che quando TA e TB sono eseguiti su due core diversi non siamo sicuri che OP1 avvenga dopo OP1, è necessario sincronizzare TA e TB in modo esplicito.</p><div class="alert alert-primary" markdown=1><h5 class=no_toc><i class="bi bi-journal-text"></i> Definizione: Sincronizzazione di thread</strong></h5><p>La <strong>sincronizzazione</strong> tra thread è un qualsiasi meccanismo che permette di eseguire in un ordine prestabilito istruzioni che sono eseguite da thread diversi.</p></div><h2 id=thread-join>Thread join</h2><p>Un meccanismo di sincronizzazione tra thread usato di frequente è chiamato <strong>join</strong> (unire), l&rsquo;idea è che i due flussi di istruzioni dei due thread coinvolti nel join si devono &ldquo;unire&rdquo; in un unico flusso. Detto in modo più semplice, un thread fa il <em>join</em> su un altro thread quando vuole aspettare la sua fine prima di proseguire. Supponiamo quindi che ci siano due thread A e B e che il thread A ad un certo possa continuare solo quando il thread B ha terminato le sue operazioni. Per <em>sincronizzare il thread A sulla &ldquo;fine&rdquo; del thread B si usa il join di A su B</em>.</p><p>Ovviamente è possibile che un thread voglia fare il join su più di un altro thread. In questo caso basta fare il join su ognuno e si ottiene questo effetto. Ad esempio, se il thread A vuole attendere la fine dei thread B,C e D, dovrà semplicemente fare il join su B, C e D. Non appena tutti saranno terminati, allora il thread A potrà riprendere l&rsquo;esecuzione.</p><p>Una caratteristica importante delle librerie di thread (es. Java o p_thread) è che il join può avvenire in qualsiasi momento <em>sia che il thread sia ancora in esecuzione sia che sia già terminato</em>. Ad esempio se A vuole fare il join su B, ma prima esegue altre operazioni che, nel frattempo, fanno terminare B, allora A potrà ancora fare il join su B ed &ldquo;istantaneamente&rdquo; verrà riattivato in quanto B ha già concluso la sua esecuzione.</p><p>Un caso molto frequente in cui il join è utilizzato è per evitare che il thread principale (es. il main di Java) termini prima che tutti gli altri thread siano terminati. Per fare questo il main thread deve fare il join su tutti i thread di cui deve aspettare la fine. Se così non è, il main potrebbe terminare prima degli altri thread ed il processo potrebbe essere terminato prima che tutti i suoi thread concludano quello che stanno facendo. Questo può essere una cosa voluta, ma il più delle volte non è così ed è sempre bene fare il join su tutti i thread prima che il programma (quindi il processo) termini.</p><h3 id=sequence-diagram-per-il-join-di-due-thread><em>Sequence diagram</em> per il join di due thread</h3><div class=row><div class=col-6><div class=mxgraph style="max-width:100%;border:1px solid transparent" data-mxgraph='{"highlight":"#0000ff","nav":true,"resize":true,"toolbar":"zoom layers tags lightbox","edit":"_blank","xml":"<mxfile host=\"app.diagrams.net\" modified=\"2021-11-03T16:17:24.966Z\" agent=\"5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36\" etag=\"7MQ56-paNJG-M4OJyBW0\" version=\"15.6.8\" type=\"google\"><diagram id=\"kgpKYQtTHZ0yAKxKKP6v\" name=\"Page-1\">5VltU6MwEP41/VgmEGjLR1tfbm50dM67Uz/GEgtnSjCk2vrrL0B4S2hLa/E6Hs447CZZwj777C5pD07mywuGIv+Kepj0LOAte/C0Z1nOEIj/iWKVKSAYZYoZC7xMZZaK2+AdS6VcN1sEHo5rEzmlhAdRXTmlYYinvKZDjNG3+rQnSupPjdAMa4rbKSK69i7wuJ9pRw4o9d9wMPPzJ5tAjsxRPlkqYh959K2igmc9OGGU8uxuvpxgkvgu90u27nzNaLExhkPeZgEMF+PzJXOnq0sQhdd3Py100ZdWXhFZyBfuwZM5CkK5Z77KHSG2HyW3izm5DJ4wCUIhjSPMgjnmmIkRItU3pW4sYOHCWjpupjIhKIqDx9QsEBqGpwsWB6/4B44z9FMtXYQe9qRUuC4VOKPPBRiJUd0T+WthxvGyopKeucBUbJCtxBQ5moepjFJbim8l5AWwfgVuayCVSIbZrLBcIiFuJBg7AGPpwKiIRDQIefpcZ9xzThU0KOM+ndEQkSoeH/Trxhhq7WzbqTl72ORs3dejrlwNNVfHHDGecriBCMl7BiJBnJBgFgrVI+WczlMHilUnSc5J3C/MCR0OvVzzSOj0OZ8mE93o0CAI2zO8aZ4MI+zV0p4OFcMEccHKekJtcL1cepMEYwlxH4JGjHMLMV2wKZaLFPyKXbSCNIxc//Lh0un//vXy/jqZfkfDxrT2VdljjtrRxzoAfby3e/JCbx+vzlZh3L++v2FPbn+k+foPTWgDuM8w8sSN7vy1HGriy2Y342XA75N7AwyGUn5IZhujAZTy6VIuT4VVRaigW7E/oYSydKdwnP6JkSdRyZr0jXxqi/vBeefYhlu9BvVYcd368LAVK7WnQGEHwpppCwAjf1puLktGhyB5Y+A5R0Nyjbz7499M8oK9n0Dyxt02+BqeZAQ3/7NW0XKOrVccHA0Rtka9s6u31WrXkgid+VqvdnmzWJQ7nRC7lDvhP7a6z0tUIjx8MLSzrL69J9zaOw4aa93Ba5hgWDPmn9Q86t8DAqbNAPt8TiQMbbCmERZDYw/FfsovMxuufBTUuVfGhOEMq2HRBwYQ3pKass1JpVVVUhudvG0SFq28TcraJte1d26b9o+9gR57mzr6rmMPgnpyt4C7X4ukniiYrhLEHTdHjQc7WQTr1eHoC/aWBmtLCVHyyacW7EZwjudwZ4tj14dW64IN2xVslR4H8/X6050v8X0K0qvdd+hO/cDBU6upHAmZ6oFe29Rqq6lVNdRxah1qEaUeePyjDrCTw4tu6qyp9ngq/1vXWXeLoY6Dwd7WLOrJ5bOaxSLjFCFkALNQ7NcsAqg2i4M9m8VdM9WmQlrtHtcfFXXQLNqGIzNweilHYg4wTLsybO8X4qalHOppjzlQxAux/Dkym17+pgvP/gI=</diagram></mxfile>"}'></div><script type=text/javascript src=https://viewer.diagrams.net/js/viewer-static.min.js></script></div><div class=col-6><p>Nella figura a sinistra vediamo il <em>sequence diagram</em> per un programma che genera due thread, li fa partire e poi si metta in attesa (<em>join</em>) prima dell&rsquo;uno , poi dell&rsquo;altro (frecce grigie).</p><p>Come si vede, non appena il main avvia (<em>start</em>) i thread, questi iniziano ad effettuare le loro operazioni, al termine delle quali (es. fine del metodo run in Java), comunicano alla libreria di gestione dei thread che hanno concluso l&rsquo;esecuzione. Se qualche altro thread (il main è eseguito in un thread) si era messo in attesa (es. con la chiamata <code>join()</code> in Java), questo viene risvegliato e può proseguire.</p><p>Nell&rsquo;esempio dopo il primo risveglio del main (indicato dalla freccia <em>end thread 1</em>), il main esegui il <em>join</em> sul secondo thread e verrà quindi risvegliato quando questo avrà terminato (indicato dalla freccia <em>end thread 2</em>).</p><p>In <a href=https://github.com/ProfSchimd/4id_2021_2022/blob/master/thread/join/MainClass.java target=_blank rel=noopener>questo file</a> si può vedere un semplice esempio in Java che realizza proprio l&rsquo;esempio mostrato in figura.</p></div></div><h2 id=race-condition>Race condition</h2><p>Il join di due o più thread non è l&rsquo;unico caso di sincronizzazione, in realtà è molto più frequente che due o più thread si sincronizzino senza dover necessariamente <em>unirsi</em> in un unico thread (<em>to join</em> per l&rsquo;appunto). Se torniamo all&rsquo;esempio della pizza, è normale pensare (come si vede nel diagramma di sequenza sopra) che per informare si aspetti che la prima farcitura sia completata ed allo stesso che per la seconda farcitura si aspetti che la pizza sia stata tolta dal forno. Se, ad esempio, la seconda farcitura venisse fatta prima che la pizza sia tolta dal forno, gli ingredienti finirebbero sul piatto o sul piano di lavoro. In altre parole, <strong>è importante l&rsquo;ordine con cui le operazioni vengono eseguite perché un ordine sbagliato produce un risultato finale sbagliato</strong> (ad esempio gli ingredienti sul piano di lavoro e non sulla pizza. Questa situazione in cui l&rsquo;esito dipende dall&rsquo;ordine di arrivo delle operazioni viene chiamata <strong>race condition</strong>.</p><div class="alert alert-primary" markdown=1><h5 class=no_toc><i class="bi bi-journal-text"></i> Definizione: Race condition</strong></h5><p>Una <strong>race condition</strong> si verifica quando l&rsquo;ordine in cui le operazioni vengono eseguite è importante affinché il risultato finale sia quello che ci si aspetta.</p></div><h3 id=esempio-di-race-condition-data-race>Esempio di race condition (data race)</h3><div class=row><div class=col-6><div class=mxgraph style="max-width:100%;border:1px solid transparent" data-mxgraph='{"highlight":"#0000ff","nav":true,"resize":true,"toolbar":"zoom layers tags lightbox","edit":"_blank","xml":"<mxfile host=\"app.diagrams.net\" modified=\"2021-12-14T22:06:48.603Z\" agent=\"5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36\" etag=\"v3TQKtmoNS0LDYQJ3NrF\" version=\"15.9.6\" type=\"google\"><diagram id=\"kgpKYQtTHZ0yAKxKKP6v\" name=\"Page-1\">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</diagram></mxfile>"}'></div><script type=text/javascript src=https://viewer.diagrams.net/js/viewer-static.min.js></script></div><div class=col-6><p>Nella figura a sinistra vediamo un esempio di <em>race condition</em> su lettura/scrittura della variabile x, essendo una race condition sulla condivisione di dati, viene anche detta <em>data race</em>.</p><p>Nel primo caso (figura in alto) il Thread1 legge, aggiorna e scrive il valore di x prima che il Thread2 legga a sua volta la variabile x. In questo caso il risultato finale è x = 2 in quanto</p><ol><li>prima x = 0 viene incrementato di 1 da Thread1</li><li>poi x = 1 viene raddoppiato da Thread2.</li></ol><p>Nel secondo caso (figura in basso), le operazioni tra Thread1 e Thread2 sono <em>intervallate</em> (<em>interleaved</em>), cosa che accade spesso nel multithreading. Anziché x=2 come nel caso precedente, alla fine x=0. Infatti</p><ol><li>contemporaneamente Thread1 e Thread2 leggono x=0</li><li>contemporaneamenteThread1 e Thread2 aggiornano x (x=1 per Thread1 e x=0 per Thread2)</li><li>Thread1 e Thread2 scrivono uno dopo l&rsquo;altro il valore (diverso) di x.
Il valore finale di x sarà dato dal thread che scrive per ultimo (nell&rsquo;esempio Thread2).</li></ol></div></div></div></article><nav class="mx-5 my-3"><div class=card><h5 class=card-header>Indice di Sincronizzazione</h5><ul class="list-group list-group-flush"><li class="list-group-item list-group-item-primary"><strong><a href=https://profschimd.github.io/materie/tpsit/4/02-sincronizzazione/sincronizzazione/>> Sincronizzazione</a></strong></li><li class=list-group-item><a href=https://profschimd.github.io/materie/tpsit/4/02-sincronizzazione/sezione_critica/>Sezione critica</a></li><li class=list-group-item><a href=https://profschimd.github.io/materie/tpsit/4/02-sincronizzazione/mutex/>Mutex, Semafori e Monitor</a></li><li class=list-group-item><a href=https://profschimd.github.io/materie/tpsit/4/02-sincronizzazione/deadlock/>Deadlock</a></li></ul><div class=card-footer><a class="btn btn-primary" href=https://profschimd.github.io/materie/tpsit/4/02-sincronizzazione/>Index</a></div></div></nav></main></div><div class="py-3 border-top bg-light mt-auto"><div class=container><div class=row><div class=col-sm><ul class=list-unstyled><li>Michele Schimd &copy; 2023</li><li><a class=pr-1 href=mailto:michele.schimd@itiszuccante.edu.it><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" fill="currentcolor" class="bi bi-at" viewBox="0 0 16 16"><path d="M.05 3.555A2 2 0 012 2h12a2 2 0 011.95 1.555L8 8.414.05 3.555zM0 4.697v7.104l5.803-3.558L0 4.697zM6.761 8.83.191 12.857A2 2 0 002 14h12a2 2 0 001.808-1.144l-6.57-4.027L8 9.586l-1.239-.757zm3.436-.586L16 11.801V4.697l-5.803 3.546z"/></svg></a><a class=pr-1 rel=me href=https://github.com/ProfSchimd target=_blank title=ProfSchimd alt=GitHub><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" fill="currentcolor" class="bi bi-github" viewBox="0 0 16 16"><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.012 8.012.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a><a class=pr-1 rel=me href=https://www.linkedin.com/in/michele-schimd-44a85160 target=_blank title=michele-schimd-44a85160 alt=Linkedin><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" fill="currentcolor" class="bi bi-linkedin" viewBox="0 0 16 16"><path d="M0 1.146C0 .513.526.0 1.175.0h13.65C15.474.0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487.0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837.0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822.0-1.359.54-1.359 1.248.0.694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869.0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274.0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54.0 01.016-.025V6.169h-2.4c.03.678.0 7.225.0 7.225h2.4z"/></svg></a><a class=pr-1 rel=me href=https://stackoverflow.com/users/18081937 target=_blank title=18081937><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" fill="currentcolor" class="bi bi-stack-overflow" viewBox="0 0 16 16"><path d="M12.412 14.572V10.29h1.428V16H1v-5.71h1.428v4.282h9.984z"/><path d="M3.857 13.145h7.137v-1.428H3.857v1.428zM10.254.0 9.108.852l4.26 5.727 1.146-.852L10.254.0zm-3.54 3.377 5.484 4.567.913-1.097L7.627 2.28l-.914 1.097zM4.922 6.55l6.47 3.013.603-1.294-6.47-3.013-.603 1.294zm-.925 3.344 6.985 1.469.294-1.398-6.985-1.468-.294 1.397z"/></svg></a></li><li><span style=font-size:small><em>Ultimo aggiornamento: 10/11/2023</em></span></li></ul></div><div class="col-lg text-right"><ul class=list-unstyled><li>Materiale di studio e di esercizio per gli alunni dello Zuccante.</li></ul><div><p><a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/><img style=float:right alt="Creative Commons License" src=https://i.creativecommons.org/l/by-nc/4.0/88x31.png></a></div></p></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js integrity=sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js integrity=sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF crossorigin=anonymous></script></body></html>
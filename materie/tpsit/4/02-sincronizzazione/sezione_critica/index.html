<!doctype html><html><head><meta charset=utf-8><title>Sezione critica &ndash; Michele Schimd</title><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://cdn.jsdelivr.net/npm/bootswatch@4.5.2/dist/spacelab/bootstrap.min.css rel=stylesheet><link href=https://profschimd.github.io/css/syntax.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css><script src=https://code.jquery.com/jquery-3.4.1.slim.min.js integrity=sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n crossorigin=anonymous></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body class="d-flex flex-column min-vh-100"><header><nav class="p-1 navbar navbar-expand-lg navbar-dark bg-primary"><div class=container><a class=navbar-brand rel=author href=https://profschimd.github.io/>Michele Schimd</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false>Materie</a><ul class=dropdown-menu aria-labelledby=navbarDropdown><li><a href=https://profschimd.github.io/materie/inf/ class=dropdown-item>Informatica</a></li><li><a href=https://profschimd.github.io/materie/sr/ class=dropdown-item>SR</a></li><li><a href=https://profschimd.github.io/materie/tpsit/ class=dropdown-item>TPSIT</a></li><li><a href=https://profschimd.github.io/materie/gpoi/ class=dropdown-item>GPOI</a></li><li><a href=https://profschimd.github.io/materie/ec/ class=dropdown-item>EC</a></li><li><a href=https://profschimd.github.io/materie/python/ class=dropdown-item>Python</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false>Classi</a><ul class=dropdown-menu aria-labelledby=navbarDropdown><li><a href=https://profschimd.github.io/classi/4ia/ class=dropdown-item>4IA</a></li><li><a href=https://profschimd.github.io/classi/4ic/ class=dropdown-item>4IC</a></li><li><a href=https://profschimd.github.io/classi/5ic/ class=dropdown-item>5IC</a></li><li><a href=https://profschimd.github.io/classi/5id/ class=dropdown-item>5ID</a></li><li><a href=https://profschimd.github.io/classi/anni-passati/ class=dropdown-item>Anni precedenti</a></li></ul></li><li class=nav-item><a class=nav-link href=https://profschimd.github.io/about/ role=button><i class="bi bi-info-circle"></i></a></li></ul></div></div></nav></header><div class="p-4 bg-primary" style="background-size:cover;background-position:50%;background-image:linear-gradient(to bottom,rgba(0,0,0,.3) 0%,rgba(0,0,0,.6) 100%),url(https://profschimd.github.io/img/zuccante_it.jpeg)"><div class=container><h1 class="display-4 text-white">Sezione critica</h1></div></div><div class=bg-light><nav aria-label="breadcrumb mt-0"><div class=container><ol class=breadcrumb><li class=breadcrumb-item><a href=https://profschimd.github.io/>Home</a></li><li class=breadcrumb-item><a href=https://profschimd.github.io/materie/>Materie</a></li><li class=breadcrumb-item><a href=https://profschimd.github.io/materie/tpsit/>TPSIT</a></li><li class=breadcrumb-item><a href=https://profschimd.github.io/materie/tpsit/4/>TPSIT - Quarto Anno</a></li><li class=breadcrumb-item><a href=https://profschimd.github.io/materie/tpsit/4/02-sincronizzazione/>Sincronizzazione</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://profschimd.github.io/materie/tpsit/4/02-sincronizzazione/sezione_critica/>Sezione critica</a></li></ol></nav></div><div class="container py-5"><main><div class=row><div class=col-10><aside><nav id=TableOfContents><ul><li><a href=#il-problema-della-sezione-critica>Il problema della sezione critica</a><ul><li><a href=#gestione-della-sezione-critica>Gestione della sezione critica</a></li></ul></li><li><a href=#sezione-critica-in-java-synchronized>Sezione critica in Java <code>synchronized</code></a></li></ul></nav></aside></div><div class=col-2></div></div><article><div class=container style=text-align:justify><h2 id=il-problema-della-sezione-critica>Il problema della sezione critica</h2><p>Un sistema <em>multithread</em> può presentare <strong>problemi di sincronizzazione dovuti all&rsquo;utilizzo da parte di due o più thread della stessa risorsa</strong>. Questa risorsa può essere un file e perfino una variabile (ricordiamo che i thread di un processo lavorano su uno spazio di memoria condiviso, quindi possono usare variabili condivise). Un esempio di questi problemi di sincronizzazione si ha in caso di <em>race condition</em> (come descritto <a href=https://profschimd.github.io/materie/tpsit/4/02-sincronizzazione/sincronizzazione/>qui</a>).</p><p>Un modo per risolvere alcuni problemi di sincronizzazione è utilizzare il concetto di <strong>regione critica</strong> (<em>critical section</em>) con la quale si garantisce che al massimo in thread stia eseguendo operazioni &ldquo;critiche&rdquo; (ad esempio, l&rsquo;aggiornamento del valore di una variabile condivisa).</p><div class="alert alert-primary" markdown=1><h5 class=no_toc><i class="bi bi-journal-text"></i> Definizione</strong></h5><p>La <strong>regione critica</strong> di un thread è una parte di codice di esecuzione del thread che può essere eseguita solo se nessun altro thread sta eseguendo la propria regione critica.</p></div><p>La regola fondamentale della regione critica è che <strong>o nessun thread sta eseguendo la propria regione critica oppure un solo thread sta eseguendo la propria regione critica</strong>.</p><p>Va inoltre osservato che <em>ogni thread ha la propria regione critica</em> e cioè il codice che è parte della regione critica di un thread può essere diverso dal codice delle regioni critiche degli altri thread. Anche se questo è vero, deve comunque essere garantito che non più di un thread stia eseguendo la propria regione critica.</p><h3 id=gestione-della-sezione-critica>Gestione della sezione critica</h3><p>Evidentemente, non possono essere i thread ad &ldquo;auto-gestirsi&rdquo; le regioni critiche, ma deve essere il sistema operativo o la libreria di gestione dei thread che si occupa di gestire l&rsquo;accesso alle regioni critiche dei thread garantendo che non ce ne sia mai più di una in esecuzione.
Qualunque sia la soluzione per risolvere il problema della regione critica, questa dovrà garantire che tutti i thread, prima o poi, possano entrare ed eseguire la propria regione critica. Per ottenere questo è necessario che il meccanismo di gestione abbia le tre seguenti caratteristiche.</p><ol><li><strong>Mutua esclusione</strong> (<em>mutual exclusion</em>) cioè che se un thread è nella propria sezione critica, nessun altro thread può eseguire la propria sezione critica.</li><li>Se un thread a richiesto l&rsquo;accesso alla sezione critica c&rsquo;è un <strong>numero massimo</strong> di volte in cui altri thread potranno farlo prima di lui.</li><li>Se non ci sono thread in regione critica, ma ce ne sono che hanno richiesto di entrarvi, in un <strong>tempo limitato</strong> uno dei thread in attesa può entrare nella zona critica.</li></ol><h2 id=sezione-critica-in-java-synchronized>Sezione critica in Java <code>synchronized</code></h2><p>Il sistema di gestione dei thread di Java mette a disposizione un meccanismo di accesso alla regione critica. L&rsquo;unica cosa che il programmatore deve fare è indicare a Java quale codice deve fare parte della regione critica, questo avviene utilizzando la parola chiave <code>synchronized</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>synchronized</span> <span class=kt>void</span> <span class=nf>incrementaContatore</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=o>.</span><span class=na>contatore</span><span class=o>++;</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></div><p>In questo caso siamo sicuri che un solo thread per volta può eseguire l&rsquo;operazione di incremento. Ovviamente perché questo sia vero è necessario che il programmatore si preoccupi non incrementare contatore in altri metodi che non siano <code>synchronized</code>.</p></div></article><nav class="mx-5 my-3"><div class=card><h5 class=card-header>Indice di Sincronizzazione</h5><ul class="list-group list-group-flush"><li class=list-group-item><a href=https://profschimd.github.io/materie/tpsit/4/02-sincronizzazione/sincronizzazione/>Sincronizzazione</a></li><li class="list-group-item list-group-item-primary"><strong><a href=https://profschimd.github.io/materie/tpsit/4/02-sincronizzazione/sezione_critica/>> Sezione critica</a></strong></li><li class=list-group-item><a href=https://profschimd.github.io/materie/tpsit/4/02-sincronizzazione/mutex/>Mutex, Semafori e Monitor</a></li><li class=list-group-item><a href=https://profschimd.github.io/materie/tpsit/4/02-sincronizzazione/deadlock/>Deadlock</a></li></ul><div class=card-footer><a class="btn btn-primary" href=https://profschimd.github.io/materie/tpsit/4/02-sincronizzazione/>Index</a></div></div></nav></main></div><div class="py-3 border-top bg-light mt-auto"><div class=container><div class=row><div class=col-sm><ul class=list-unstyled><li>Michele Schimd &copy; 2022</li><li><a class=pr-1 href=mailto:michele.schimd@itiszuccante.edu.it><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" fill="currentcolor" class="bi bi-at" viewBox="0 0 16 16"><path d="M.05 3.555A2 2 0 012 2h12a2 2 0 011.95 1.555L8 8.414.05 3.555zM0 4.697v7.104l5.803-3.558L0 4.697zM6.761 8.83.191 12.857A2 2 0 002 14h12a2 2 0 001.808-1.144l-6.57-4.027L8 9.586l-1.239-.757zm3.436-.586L16 11.801V4.697l-5.803 3.546z"/></svg></a><a class=pr-1 rel=me href=https://github.com/ProfSchimd target=_blank title=ProfSchimd alt=GitHub><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" fill="currentcolor" class="bi bi-github" viewBox="0 0 16 16"><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.012 8.012.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a><a class=pr-1 rel=me href=https://www.linkedin.com/in/michele-schimd-44a85160 target=_blank title=michele-schimd-44a85160 alt=Linkedin><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" fill="currentcolor" class="bi bi-linkedin" viewBox="0 0 16 16"><path d="M0 1.146C0 .513.526.0 1.175.0h13.65C15.474.0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487.0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837.0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822.0-1.359.54-1.359 1.248.0.694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869.0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274.0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54.0 01.016-.025V6.169h-2.4c.03.678.0 7.225.0 7.225h2.4z"/></svg></a><a class=pr-1 rel=me href=https://stackoverflow.com/users/18081937 target=_blank title=18081937><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" fill="currentcolor" class="bi bi-stack-overflow" viewBox="0 0 16 16"><path d="M12.412 14.572V10.29h1.428V16H1v-5.71h1.428v4.282h9.984z"/><path d="M3.857 13.145h7.137v-1.428H3.857v1.428zM10.254.0 9.108.852l4.26 5.727 1.146-.852L10.254.0zm-3.54 3.377 5.484 4.567.913-1.097L7.627 2.28l-.914 1.097zM4.922 6.55l6.47 3.013.603-1.294-6.47-3.013-.603 1.294zm-.925 3.344 6.985 1.469.294-1.398-6.985-1.468-.294 1.397z"/></svg></a></li><li><span style=font-size:small><em>Ultimo aggiornamento: 15/12/2022</em></span></li></ul></div><div class="col-lg text-right"><ul class=list-unstyled><li>Materiale di studio e di esercizio per gli alunni dello Zuccante.</li></ul><div><p><a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/><img style=float:right alt="Creative Commons License" src=https://i.creativecommons.org/l/by-nc/4.0/88x31.png></a></div></p></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js integrity=sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js integrity=sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF crossorigin=anonymous></script></body></html>
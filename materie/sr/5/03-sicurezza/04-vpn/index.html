<!doctype html><html><head><meta charset=utf-8><title>Virtual Private Network (VPN) &ndash; Michele Schimd
</title><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://cdn.jsdelivr.net/npm/bootswatch@4.5.2/dist/spacelab/bootstrap.min.css rel=stylesheet><link href=https://profschimd.github.io/css/syntax.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css><script src=https://code.jquery.com/jquery-3.4.1.slim.min.js integrity=sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n crossorigin=anonymous></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body class="d-flex flex-column min-vh-100"><header><nav class="p-1 navbar navbar-expand-lg navbar-dark bg-primary"><div class=container><a class=navbar-brand rel=author href=https://profschimd.github.io/>Michele Schimd</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false>Materie</a><ul class=dropdown-menu aria-labelledby=navbarDropdown><li><a href=https://profschimd.github.io/materie/inf/ class=dropdown-item>Informatica</a></li><li><a href=https://profschimd.github.io/materie/sr/ class=dropdown-item>SR</a></li><li><a href=https://profschimd.github.io/materie/tpsit/ class=dropdown-item>TPSIT</a></li><li><a href=https://profschimd.github.io/materie/gpoi/ class=dropdown-item>GPOI</a></li><li><a href=https://profschimd.github.io/materie/ec/ class=dropdown-item>EC</a></li><li><a href=https://profschimd.github.io/materie/python/ class=dropdown-item>Python</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false>Classi</a><ul class=dropdown-menu aria-labelledby=navbarDropdown><li><a href=https://profschimd.github.io/classi/3ic/ class=dropdown-item>3IC</a></li><li><a href=https://profschimd.github.io/classi/4ic/ class=dropdown-item>4IC</a></li><li><a href=https://profschimd.github.io/classi/4ia/ class=dropdown-item>5IA</a></li><li><a href=https://profschimd.github.io/classi/5ic/ class=dropdown-item>5IC</a></li><li><a href=https://profschimd.github.io/classi/anni-passati/ class=dropdown-item>Anni precedenti</a></li></ul></li><li class=nav-item><a class=nav-link href=https://profschimd.github.io/about/ role=button><i class="bi bi-info-circle"></i></a></li></ul></div></div></nav></header><div class="p-4 bg-primary" style="background-size:cover;background-position:50%;background-image:linear-gradient(to bottom,rgba(0,0,0,.3) 0%,rgba(0,0,0,.6) 100%),url(https://profschimd.github.io/img/zuccante_it.jpeg)"><div class=container><h1 class="display-4 text-white">Virtual Private Network (VPN)</h1></div></div><div class=bg-light><nav aria-label="breadcrumb mt-0"><div class=container><ol class="breadcrumb py-0 my-1 small"><li class=breadcrumb-item><a href=https://profschimd.github.io/>Home</a></li><li class=breadcrumb-item><a href=https://profschimd.github.io/materie/>Materie</a></li><li class=breadcrumb-item><a href=https://profschimd.github.io/materie/sr/>Sistemi e Reti</a></li><li class=breadcrumb-item><a href=https://profschimd.github.io/materie/sr/5/>Quinto anno</a></li><li class=breadcrumb-item><a href=https://profschimd.github.io/materie/sr/5/03-sicurezza/>Sicurezza nelle reti</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://profschimd.github.io/materie/sr/5/03-sicurezza/04-vpn/>VPN</a></li></ol></nav></div><div class="container py-5"><main><div class=row><div class=col-10><aside><nav id=TableOfContents><ul><li><a href=#cosè-una-vpn>Cos&rsquo;è una VPN</a><ul><li><a href=#tunnelling>Tunnelling</a></li></ul></li><li><a href=#ipsec>IPsec</a></li><li><a href=#i-protocolli-di-ipsec>I protocolli di IPsec</a><ul><li><a href=#authentication-header-ah>Authentication Header (AH)</a></li><li><a href=#encapsulating-security-payload-esp>Encapsulating Security Payload (ESP)</a></li><li><a href=#modalità-di-funzionamento>Modalità di funzionamento</a></li></ul></li><li><a href=#link>Link</a></li></ul></nav></aside></div><div class=col-2></div></div><article><div class=container style=text-align:justify><h2 id=cosè-una-vpn>Cos&rsquo;è una VPN</h2><p>Con la pandemia da SARS-Cov-2, ci si è resi conto dell&rsquo;importanza dello <em>smart working</em> (<em>lavoro agile</em>), molte istituzioni e aziende hanno potuto lavorare nonostante il <em>lockdown</em>. Uno dei problemi dello <em>smart working</em> è l&rsquo;utilizzo di connessioni diverse da quelle aziendali. Questo può rendere inaccessibili alcune risorse utilizzabili solo all&rsquo;interno della <strong>intranet</strong> aziendale. In altre parole, risorse accessibili solo se direttamente connessi alla <em>rete privata</em> aziendale, non sono disponibili se connessi alla <em>rete pubblica</em> Internet e questo può essere un ostacolo, ad esempio, nello smart working.</p><p>È possibile creare una rete privata <em>virtuale</em> utilizzando anche infrastruttura che non è di proprietà dell&rsquo;istituzione (es. utilizzando la stessa fibra utilizzata anche degli <em>Internet Server Provider - ISP</em>), questo tipo di rete prende il nome di <strong>Virtual Private Network (VPN)</strong>.</p><p>La tecnologia alla base delle VPN è <strong>IPsec</strong> che permette di scambiare pacchetti IP cifrati, in questo modo si ottiene un livello di sicurezza tale da consentire di includere nella rete privata anche <em>host</em> che non sono ad essa collegati. Si dice che la connessione <em>pubblica</em> (ad esempio attraverso il proprio ISP), viene usata come <em>tunnel</em> (si parla infatti di <strong>tunnelling</strong>) all&rsquo;interno del quale transita il traffico della rete privata. Essendo questo tunnel protetto dalla cifratura offerta da IPsec, la connessione VPN viene considerata sicura e parte della rete privata.</p><div class="alert alert-danger" markdown=1><h5 class="alert-danger no_toc"><i class="bi bi-exclamation-triangle"></i> Attenzione</strong></h5><p>È importante sottolineare che l&rsquo;utilizzo di IPsec è uno dei tanti metodi per creare una VPN. Sulla
pagina di Wikipedia per la voce <a href=https://en.wikipedia.org/wiki/Virtual_private_network target=_blank rel=noopener>VPN</a>, si trova una maggiore trattazione. Con un colpo d&rsquo;occhio <a href=https://upload.wikimedia.org/wikipedia/commons/thumb/0/09/VPN_classification-en.svg/2560px-VPN_classification-en.svg.png target=_blank rel=noopener>questa immagine</a> (tratta dalla stessa pagine) mostra diversi tipi di VPN sono oggi disponibili.</p></div><h3 id=tunnelling>Tunnelling</h3><p>Il <strong>tunnelling</strong> prevede l&rsquo;utilizzo una rete (ad esempio Internet) per trasportare pacchetti appartenenti ad un&rsquo;altra rete (ad esempio la rete aziendale private). Si utilizzano i servizi e i protocolli di una rete per creare un <em>tunnel</em> che metta in collegamento du dispositivi appartenenti ad una stessa rete, ma che non sono fisicamente collegati.</p><div class=row><div class=col-6><p>L&rsquo;immagine a fianco schematizza il tunnelling attraverso una rete pubblica, i dispositivi delle due reti coinvolte (<em>home network</em> e <em>company network</em> nell&rsquo;esempio) comunicano utilizzando i servizi della rete pubblica (ad esempio il protocollo IP su Internet).</p><p>Se la comunicazione è opportunamente gestita (ad esempio cifrata), si viene a creare un <em>tunnel</em> che collega le due reti, questo tunnel può essere visto come un collegamento virtuale tra due dispositivi della stessa rete. In questo caso il laptop all&rsquo;interno della rete di casa ottiene un accesso alla rete aziendale mediante il tunnel stesso, questo collegamento virtuale permette al laptop ed al server di comunicare come se si trovassero nella stessa rete privata. Essendo la rete privata creata utilizzando anche collegamenti virtuale (il tunnel), diciamo che i dispositivi si trovano sulla stessa rete privata virtuale (una VPN).</p></div><div class=col-6><div class=mxgraph style="max-width:100%;border:1px solid transparent" data-mxgraph='{"highlight":"#0000ff","nav":true,"resize":true,"toolbar":"zoom layers tags lightbox","edit":"_blank","xml":"<mxfile host=\"app.diagrams.net\" modified=\"2023-04-07T10:06:17.915Z\" agent=\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36\" etag=\"t1lgw8YPsJHbjrgSsHPu\" version=\"21.1.5\" type=\"google\">\n  <diagram name=\"Page-1\" id=\"yrVY5EEmj7aHvN9JORHr\">\n    <mxGraphModel dx=\"1590\" dy=\"827\" grid=\"1\" gridSize=\"10\" guides=\"1\" tooltips=\"1\" connect=\"1\" arrows=\"1\" fold=\"1\" page=\"1\" pageScale=\"1\" pageWidth=\"1169\" pageHeight=\"827\" math=\"0\" shadow=\"0\">\n      <root>\n        <mxCell id=\"0\" />\n        <mxCell id=\"1\" parent=\"0\" />\n        <mxCell id=\"IOP7wVzOMJGK56kOmuT_-11\" value=\"Virtual Private Network\" style=\"rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=24;fontFamily=Times New Roman;fontColor=#000066;\" vertex=\"1\" parent=\"1\">\n          <mxGeometry x=\"250\" y=\"370\" width=\"670\" height=\"130\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"e9ftTa3H-ScVXAW1ixtv-13\" value=\"Company&amp;lt;br style=&amp;quot;font-size: 24px;&amp;quot;&amp;gt;Network\" style=\"ellipse;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=24;fontFamily=Times New Roman;labelPosition=center;verticalLabelPosition=bottom;align=center;verticalAlign=top;fontColor=#333333;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"716.84\" y=\"50\" width=\"203.16\" height=\"184\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"e9ftTa3H-ScVXAW1ixtv-8\" value=\"Home&amp;lt;br style=&amp;quot;font-size: 24px;&amp;quot;&amp;gt;Network\" style=\"ellipse;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=24;fontFamily=Times New Roman;labelPosition=center;verticalLabelPosition=bottom;align=center;verticalAlign=top;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"250\" y=\"40\" width=\"200\" height=\"190\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"e9ftTa3H-ScVXAW1ixtv-1\" value=\"\" style=\"image;html=1;image=img/lib/clip_art/computers/Laptop_128x128.png;fontSize=24;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"320\" y=\"102\" width=\"80\" height=\"80\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"e9ftTa3H-ScVXAW1ixtv-6\" value=\"\" style=\"image;html=1;image=img/lib/clip_art/computers/Mainframe_128x128.png\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"790\" y=\"95\" width=\"80\" height=\"80\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"e9ftTa3H-ScVXAW1ixtv-7\" value=\"Public&amp;lt;br style=&amp;quot;font-size: 24px;&amp;quot;&amp;gt;Network\" style=\"image;aspect=fixed;perimeter=ellipsePerimeter;html=1;align=center;shadow=0;dashed=0;spacingTop=3;image=img/lib/active_directory/internet_cloud.svg;fontSize=24;fontFamily=Times New Roman;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"450\" y=\"40\" width=\"269.84\" height=\"170\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"e9ftTa3H-ScVXAW1ixtv-15\" value=\"\" style=\"shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;rotation=90;fillColor=#ffe6cc;strokeColor=#d79b00;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"585\" y=\"-59\" width=\"31\" height=\"402\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"e9ftTa3H-ScVXAW1ixtv-16\" value=\"Tunnel\" style=\"text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontFamily=Times New Roman;fontColor=#663300;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"400\" y=\"127\" width=\"400\" height=\"30\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"IOP7wVzOMJGK56kOmuT_-4\" value=\"\" style=\"image;html=1;image=img/lib/clip_art/computers/Laptop_128x128.png;fontSize=24;fillColor=#dae8fc;strokeColor=#6c8ebf;\" vertex=\"1\" parent=\"1\">\n          <mxGeometry x=\"320\" y=\"402\" width=\"80\" height=\"80\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"IOP7wVzOMJGK56kOmuT_-5\" value=\"\" style=\"image;html=1;image=img/lib/clip_art/computers/Mainframe_128x128.png\" vertex=\"1\" parent=\"1\">\n          <mxGeometry x=\"790\" y=\"395\" width=\"80\" height=\"80\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"IOP7wVzOMJGK56kOmuT_-12\" value=\"\" style=\"shape=singleArrow;direction=south;whiteSpace=wrap;html=1;arrowWidth=0.47826086956521907;arrowSize=0.4023715415019751;fillColor=#e1d5e7;strokeColor=#9673a6;\" vertex=\"1\" parent=\"1\">\n          <mxGeometry x=\"540\" y=\"290\" width=\"90\" height=\"70\" as=\"geometry\" />\n        </mxCell>\n      </root>\n    </mxGraphModel>\n  </diagram>\n</mxfile>\n"}'></div><script type=text/javascript src=https://viewer.diagrams.net/js/viewer-static.min.js></script></div></div><p>Per ottenere il tunnelling, quindi, dobbiamo utilizzare una comunicazione tra host in grado di rendere leggibile il contenuto solo ai dispositivi coinvolti nella comunicazione (oppure ai soli dispositivi nella VPN), uno dei meccanismi per ottenere quest è <a href=#ipsec>IPsec</a> discusso qui sotto.</p><h2 id=ipsec>IPsec</h2><p>Il protocollo <em>Transport Layer Security</em> TLS permette di cifrare i dati spediti attraverso una connessione TCP, tuttavia sia l&rsquo;header TCP, sia l&rsquo;header IP vengono spediti in chiaro. D&rsquo;altro canto, l&rsquo;instradamento del pacchetto IP se il suo header fosse cifrato. In una rete privata vogliamo nascondere informazioni sulla rete stessa, tipicamente indirizzi IP, server accessibili, messaggi scambiati, ed altre informazioni simili.</p><p>Il protocolli che compongono il sistema <strong>IPsec</strong> (RFC 4301, 4302 e 4303) permettono di cifrare pacchetti IP e, di conseguenza, cifrare anche il contenuto (<em>payload</em>) di tali pacchetti. Questo risolve il problema di nascondere i dettagli di una rete, ma come instradiamo questi pacchetti? Utilizziamo, <strong>in chiaro</strong> un protocollo che permetta il tunnelling come IP. Vale la pena ripetere: IPsec è un protocollo IP cifrato che utilizza IP in chiaro per fare tunnelling (cioè per essere consegnato a destinazione).</p><p>Per capire meglio come questo funziona vediamo un esempio pratico di un VPN tra nodi geograficamente distribuiti che utilizzano la rete pubblica Internet, ed in particolare IP, per fare tunnelling.</p><div class=py-3><div class=mxgraph style="max-width:100%;border:1px solid transparent" data-mxgraph='{"highlight":"#0000ff","nav":true,"resize":true,"toolbar":"zoom layers tags lightbox","edit":"_blank","xml":"<mxfile host=\"app.diagrams.net\" modified=\"2023-04-07T12:44:40.420Z\" agent=\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36\" etag=\"zzHJaUFo2sPjIKE-OC9U\" version=\"21.1.5\" type=\"google\">\n  <diagram id=\"JL0qtav-Qswu6B-wsxRO\" name=\"Page-1\">\n    <mxGraphModel dx=\"954\" dy=\"496\" grid=\"1\" gridSize=\"10\" guides=\"1\" tooltips=\"1\" connect=\"1\" arrows=\"1\" fold=\"1\" page=\"1\" pageScale=\"1\" pageWidth=\"1169\" pageHeight=\"827\" math=\"0\" shadow=\"0\">\n      <root>\n        <mxCell id=\"0\" />\n        <mxCell id=\"1\" parent=\"0\" />\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-1\" value=\"ISP Gateway\" style=\"shape=mxgraph.cisco.routers.router;sketch=0;html=1;pointerEvents=1;dashed=0;fillColor=#036897;strokeColor=#ffffff;strokeWidth=2;verticalLabelPosition=bottom;verticalAlign=top;align=center;outlineConnect=0;fontSize=16;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"451\" y=\"330\" width=\"78\" height=\"53\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-2\" value=\"Company&amp;lt;br style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;Gateway\" style=\"shape=mxgraph.cisco.routers.router;sketch=0;html=1;pointerEvents=1;dashed=0;fillColor=#036897;strokeColor=#ffffff;strokeWidth=2;verticalLabelPosition=bottom;verticalAlign=top;align=center;outlineConnect=0;fontSize=16;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"643\" y=\"330\" width=\"78\" height=\"53\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-3\" value=\"Home&amp;lt;br&amp;gt;Router\" style=\"shape=mxgraph.cisco.routers.router;sketch=0;html=1;pointerEvents=1;dashed=0;fillColor=#036897;strokeColor=#ffffff;strokeWidth=2;verticalLabelPosition=middle;verticalAlign=middle;align=right;outlineConnect=0;fontSize=16;labelPosition=left;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"227\" y=\"170\" width=\"78\" height=\"53\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-4\" value=\"Home Workstation\" style=\"shape=mxgraph.cisco.computers_and_peripherals.laptop;sketch=0;html=1;pointerEvents=1;dashed=0;fillColor=#036897;strokeColor=#ffffff;strokeWidth=2;verticalLabelPosition=top;verticalAlign=bottom;align=center;outlineConnect=0;labelPosition=center;fontSize=16;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"221\" y=\"50\" width=\"90\" height=\"61\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-5\" value=\"\" style=\"shape=mxgraph.cisco.servers.file_server;sketch=0;html=1;pointerEvents=1;dashed=0;fillColor=#036897;strokeColor=#ffffff;strokeWidth=2;verticalLabelPosition=bottom;verticalAlign=top;align=center;outlineConnect=0;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"953\" y=\"260\" width=\"43\" height=\"58\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-7\" value=\"\" style=\"shape=mxgraph.cisco.servers.file_server;sketch=0;html=1;pointerEvents=1;dashed=0;fillColor=#036897;strokeColor=#ffffff;strokeWidth=2;verticalLabelPosition=bottom;verticalAlign=top;align=center;outlineConnect=0;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"953\" y=\"366\" width=\"43\" height=\"58\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-8\" value=\"Servers&amp;lt;br style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;Switch\" style=\"shape=mxgraph.cisco.switches.workgroup_switch;sketch=0;html=1;pointerEvents=1;dashed=0;fillColor=#036897;strokeColor=#ffffff;strokeWidth=2;verticalLabelPosition=bottom;verticalAlign=top;align=center;outlineConnect=0;fontSize=16;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"803\" y=\"333\" width=\"101\" height=\"50\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-9\" value=\"Workstations&amp;lt;br style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;Switch\" style=\"shape=mxgraph.cisco.switches.workgroup_switch;sketch=0;html=1;pointerEvents=1;dashed=0;fillColor=#036897;strokeColor=#ffffff;strokeWidth=2;verticalLabelPosition=middle;verticalAlign=middle;align=left;outlineConnect=0;fontSize=16;labelPosition=right;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"631.5\" y=\"220\" width=\"101\" height=\"50\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-10\" value=\"\" style=\"shape=mxgraph.cisco.computers_and_peripherals.pc;sketch=0;html=1;pointerEvents=1;dashed=0;fillColor=#036897;strokeColor=#ffffff;strokeWidth=2;verticalLabelPosition=bottom;verticalAlign=top;align=center;outlineConnect=0;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"725\" y=\"50\" width=\"78\" height=\"70\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-11\" value=\"Intranet&amp;lt;br&amp;gt;Workstations\" style=\"shape=mxgraph.cisco.computers_and_peripherals.pc;sketch=0;html=1;pointerEvents=1;dashed=0;fillColor=#036897;strokeColor=#ffffff;strokeWidth=2;verticalLabelPosition=top;verticalAlign=bottom;align=center;outlineConnect=0;fontSize=16;labelPosition=center;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"643\" y=\"50\" width=\"78\" height=\"70\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-12\" value=\"\" style=\"shape=mxgraph.cisco.computers_and_peripherals.pc;sketch=0;html=1;pointerEvents=1;dashed=0;fillColor=#036897;strokeColor=#ffffff;strokeWidth=2;verticalLabelPosition=bottom;verticalAlign=top;align=center;outlineConnect=0;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"551\" y=\"50\" width=\"78\" height=\"70\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-13\" value=\"\" style=\"shape=mxgraph.cisco.storage.cloud;sketch=0;html=1;pointerEvents=1;dashed=0;fillColor=#036897;strokeColor=#ffffff;strokeWidth=2;verticalLabelPosition=bottom;verticalAlign=top;align=center;outlineConnect=0;\" parent=\"1\" vertex=\"1\">\n          <mxGeometry x=\"173\" y=\"303.5\" width=\"186\" height=\"106\" as=\"geometry\" />\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-16\" value=\"\" style=\"endArrow=none;html=1;rounded=0;fontColor=#FFFFFF;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;strokeWidth=2;\" parent=\"1\" source=\"b6GeVa_kPtbruaFV3dWg-3\" target=\"b6GeVa_kPtbruaFV3dWg-4\" edge=\"1\">\n          <mxGeometry width=\"50\" height=\"50\" relative=\"1\" as=\"geometry\">\n            <mxPoint x=\"611\" y=\"330\" as=\"sourcePoint\" />\n            <mxPoint x=\"661\" y=\"280\" as=\"targetPoint\" />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-17\" value=\"\" style=\"endArrow=none;html=1;rounded=0;fontColor=#FFFFFF;strokeWidth=2;entryX=0.5;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;\" parent=\"1\" source=\"b6GeVa_kPtbruaFV3dWg-13\" target=\"b6GeVa_kPtbruaFV3dWg-3\" edge=\"1\">\n          <mxGeometry width=\"50\" height=\"50\" relative=\"1\" as=\"geometry\">\n            <mxPoint x=\"276\" y=\"180\" as=\"sourcePoint\" />\n            <mxPoint x=\"276\" y=\"121\" as=\"targetPoint\" />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-18\" value=\"\" style=\"endArrow=none;html=1;rounded=0;fontColor=#FFFFFF;exitX=0;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;strokeWidth=2;entryX=0.98;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;\" parent=\"1\" source=\"b6GeVa_kPtbruaFV3dWg-1\" target=\"b6GeVa_kPtbruaFV3dWg-13\" edge=\"1\">\n          <mxGeometry width=\"50\" height=\"50\" relative=\"1\" as=\"geometry\">\n            <mxPoint x=\"286\" y=\"190\" as=\"sourcePoint\" />\n            <mxPoint x=\"286\" y=\"131\" as=\"targetPoint\" />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-19\" value=\"\" style=\"endArrow=none;html=1;rounded=0;fontColor=#FFFFFF;exitX=0.5;exitY=0.98;exitDx=0;exitDy=0;exitPerimeter=0;strokeWidth=2;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;\" parent=\"1\" source=\"b6GeVa_kPtbruaFV3dWg-9\" target=\"b6GeVa_kPtbruaFV3dWg-2\" edge=\"1\">\n          <mxGeometry width=\"50\" height=\"50\" relative=\"1\" as=\"geometry\">\n            <mxPoint x=\"461\" y=\"366.5000000000001\" as=\"sourcePoint\" />\n            <mxPoint x=\"365.28\" y=\"366.5\" as=\"targetPoint\" />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-20\" value=\"\" style=\"endArrow=none;html=1;rounded=0;fontColor=#FFFFFF;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;strokeWidth=2;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;\" parent=\"1\" source=\"b6GeVa_kPtbruaFV3dWg-1\" target=\"b6GeVa_kPtbruaFV3dWg-2\" edge=\"1\">\n          <mxGeometry width=\"50\" height=\"50\" relative=\"1\" as=\"geometry\">\n            <mxPoint x=\"471\" y=\"376.5000000000001\" as=\"sourcePoint\" />\n            <mxPoint x=\"375.28\" y=\"376.5\" as=\"targetPoint\" />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-21\" value=\"\" style=\"endArrow=none;html=1;rounded=0;fontColor=#FFFFFF;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;strokeWidth=2;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;\" parent=\"1\" source=\"b6GeVa_kPtbruaFV3dWg-11\" target=\"b6GeVa_kPtbruaFV3dWg-9\" edge=\"1\">\n          <mxGeometry width=\"50\" height=\"50\" relative=\"1\" as=\"geometry\">\n            <mxPoint x=\"692\" y=\"279.0000000000001\" as=\"sourcePoint\" />\n            <mxPoint x=\"692\" y=\"340\" as=\"targetPoint\" />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-22\" value=\"\" style=\"endArrow=none;html=1;rounded=0;fontColor=#FFFFFF;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;strokeWidth=2;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;\" parent=\"1\" source=\"b6GeVa_kPtbruaFV3dWg-2\" target=\"b6GeVa_kPtbruaFV3dWg-8\" edge=\"1\">\n          <mxGeometry width=\"50\" height=\"50\" relative=\"1\" as=\"geometry\">\n            <mxPoint x=\"702\" y=\"289.0000000000001\" as=\"sourcePoint\" />\n            <mxPoint x=\"702\" y=\"350\" as=\"targetPoint\" />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-23\" value=\"\" style=\"endArrow=none;html=1;rounded=0;fontColor=#FFFFFF;strokeWidth=2;\" parent=\"1\" source=\"b6GeVa_kPtbruaFV3dWg-12\" target=\"b6GeVa_kPtbruaFV3dWg-9\" edge=\"1\">\n          <mxGeometry width=\"50\" height=\"50\" relative=\"1\" as=\"geometry\">\n            <mxPoint x=\"712\" y=\"299.0000000000001\" as=\"sourcePoint\" />\n            <mxPoint x=\"712\" y=\"360\" as=\"targetPoint\" />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-24\" value=\"\" style=\"endArrow=none;html=1;rounded=0;fontColor=#FFFFFF;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;strokeWidth=2;\" parent=\"1\" source=\"b6GeVa_kPtbruaFV3dWg-10\" target=\"b6GeVa_kPtbruaFV3dWg-9\" edge=\"1\">\n          <mxGeometry width=\"50\" height=\"50\" relative=\"1\" as=\"geometry\">\n            <mxPoint x=\"722\" y=\"309.0000000000001\" as=\"sourcePoint\" />\n            <mxPoint x=\"722\" y=\"370\" as=\"targetPoint\" />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-26\" value=\"\" style=\"endArrow=none;html=1;rounded=0;fontColor=#FFFFFF;exitX=0.98;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;strokeWidth=2;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;\" parent=\"1\" source=\"b6GeVa_kPtbruaFV3dWg-8\" target=\"b6GeVa_kPtbruaFV3dWg-7\" edge=\"1\">\n          <mxGeometry width=\"50\" height=\"50\" relative=\"1\" as=\"geometry\">\n            <mxPoint x=\"731\" y=\"366.5000000000001\" as=\"sourcePoint\" />\n            <mxPoint x=\"813\" y=\"368\" as=\"targetPoint\" />\n          </mxGeometry>\n        </mxCell>\n        <mxCell id=\"b6GeVa_kPtbruaFV3dWg-27\" value=\"\" style=\"endArrow=none;html=1;rounded=0;fontColor=#FFFFFF;exitX=1;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;strokeWidth=2;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;\" parent=\"1\" source=\"b6GeVa_kPtbruaFV3dWg-8\" target=\"b6GeVa_kPtbruaFV3dWg-5\" edge=\"1\">\n          <mxGeometry width=\"50\" height=\"50\" relative=\"1\" as=\"geometry\">\n            <mxPoint x=\"741\" y=\"376.5000000000001\" as=\"sourcePoint\" />\n            <mxPoint x=\"823\" y=\"378\" as=\"targetPoint\" />\n          </mxGeometry>\n        </mxCell>\n      </root>\n    </mxGraphModel>\n  </diagram>\n</mxfile>\n"}'></div><script type=text/javascript src=https://viewer.diagrams.net/js/viewer-static.min.js></script></div><p>Nella figura sopra vediamo un classico scenario in cui un&rsquo;azienda possiede una propria Intranet nella quale trovano posto sia server aziendali, sia workstation per i dipendenti. Supponiamo che <strong>l&rsquo;azienda non voglia esporre sulla rete pubblica i server</strong>. Tuttavia, questi server sono indispensabili per le operazioni interne e devono essere accessibili anche da eventuali dipendenti che stanno lavorando dalla propria postazione di casa (es. in <em>smart working</em>). La soluzione è creare una VPN tra la intranet aziendale e le workstation &ldquo;remote&rdquo;, in questo caso accadrebbe quanto segue.</p><ol><li>La workstation di casa ottiene una <strong>chiave</strong> crittografica (es. installando una VPN) con la quale cifra pacchetti IP.</li><li>Per spedire questi pacchetti IP cifrati, la workstation utilizza la rete Internet pubblica mandando all&rsquo;indirizzo pubblico del <em>gateway aziendale</em> il <strong>pacchetto IP contenente il pacchetto IP cifrato</strong>.</li><li>Il <em>gateway aziendale</em> conosce la chiave condivisa ed estrae dal pacchetto IP in chiaro il suo contenuto decifrandolo.</li><li>Da questo momento in avanti, il pacchetto <strong>IP intranet</strong> può viaggiare (in chiaro) all&rsquo;interno della rete aziendale, come se fosse stato generato dalla rete interna stessa.</li></ol><div class="alert alert-danger" markdown=1><h5 class="alert-danger no_toc"><i class="bi bi-exclamation-triangle"></i> Attenzione</strong></h5><p>Affinché il meccanismo descritto sopra funzioni, il <em>gateway aziendali</em> dovrà operare da <a href=https://profschimd.github.io/materie/sr/5/03-sicurezza/03-nat/ target=_blank rel=noopener>NAT</a> traducendo l&rsquo;indirizzo IP pubblico della workstation remota in un indirizzo IP di intranet.</p></div><h2 id=i-protocolli-di-ipsec>I protocolli di IPsec</h2><p>IPsec non è un protocollo, bensì una collezione di protocolli che sono utilizzati per effettuare operazioni sicure quali, ad esempio, il tunnelling a richiesto da una VPN. I due principali protocolli sono <a href=#authentication-header-ah><em>Authentication Header (AH)</em></a> e <a href=#encapsulating-security-payload-esp>Encapsulation Security Payload (ESP)</a>, insieme questi due protocolli permettono di realizzare i requisiti di confidenzialità, integrità e autenticazione (CIA).</p><h3 id=authentication-header-ah>Authentication Header (AH)</h3><p>IP <strong>Authentication Header (AH)</strong> (<a href=https://www.rfc-editor.org/rfc/rfc4302 target=_blank rel=noopener>RFC 4302</a>) è progettato per fornire:</p><ul><li><em>autenticazione</em> dei pacchetti IP;</li><li><em>integrità</em>.</li></ul><h3 id=encapsulating-security-payload-esp>Encapsulating Security Payload (ESP)</h3><p>IP <strong>Encapsulating Security Payload (ESP)</strong> (<a href=https://www.rfc-editor.org/rfc/rfc4303 target=_blank rel=noopener>RFC 4303</a>) è progettato per fornire</p><ul><li><em>confidenzialità</em> utilizzando cifratura su pacchetti IP;</li><li><em>integrità</em> utilizzando meccanismi basati su funzioni hash;</li><li><em>autenticazione della sorgente</em> di un pacchetto IP;</li><li>altri meccanismi di sicurezza.</li></ul><h3 id=modalità-di-funzionamento>Modalità di funzionamento</h3><p>I protocolli AH ed ESP possono operare in due modalità:</p><ul><li><em>transport mode</em> e, as well as in a network</li><li><em>tunneling mode</em>.</li></ul><h4 id=modalità-transport>Modalità Transport</h4><p>Il <em>payload</em> del pacchetto IP viene cifrato e/o autenticato, mentre l&rsquo;header no.
In altre parole, i meccanismi di sicurezza sono messi in atto solo sui dati del
<em>livello di trasporto</em>.</p><h4 id=modalità-tunnel>Modalità Tunnel</h4><p>L&rsquo;intero pacchetto IP (header e payload) vine cifrato e/o autenticato, tale
pacchetto viene poi inserito come payload di un secondo pacchetto IP il cui header
deve essere visibile ai router per le operazioni di instradamento.</p><p>La modalità tunnel è quella tipicamente usata per creare una VPN, i pacchetti IP
della rete privata (virtuale) sono a loro volta incapsulati in pacchetti IP
pubblici. In questo caso <strong>IP è tunneled su IP</strong>.</p><h2 id=link>Link</h2><ul><li><a href=https://en.wikipedia.org/wiki/Virtual_private_network target=_blank rel=noopener>VPN (Wikipedia EN)</a></li><li><a href=https://en.wikipedia.org/wiki/Tunneling_protocol target=_blank rel=noopener>Tunnelling (Wikipedia EN)</a></li><li><a href=https://en.wikipedia.org/wiki/IPsec target=_blank rel=noopener>IPsec (Wikipedia EN)</a></li><li><a href=https://www.rfc-editor.org/rfc/rfc4302 target=_blank rel=noopener>RFC 4302</a></li><li><a href=https://www.rfc-editor.org/rfc/rfc4303 target=_blank rel=noopener>RFC 4303</a></li></ul></div></article><nav class="mx-5 my-3"><div class=card><h5 class=card-header>Indice di Sicurezza nelle reti</h5><ul class="list-group list-group-flush"><li class=list-group-item><a href=https://profschimd.github.io/materie/sr/5/03-sicurezza/01-ciaa/>Requisiti di sicurezza</a></li><li class=list-group-item><a href=https://profschimd.github.io/materie/sr/5/03-sicurezza/02-firewall/>Firewall</a></li><li class=list-group-item><a href=https://profschimd.github.io/materie/sr/5/03-sicurezza/03-nat/>Network Address Translation (NAT)</a></li><li class="list-group-item list-group-item-primary"><strong><a href=https://profschimd.github.io/materie/sr/5/03-sicurezza/04-vpn/>> Virtual Private Network (VPN)</a></strong></li></ul><div class=card-footer><a class="btn btn-primary" href=https://profschimd.github.io/materie/sr/5/03-sicurezza/>Index</a></div></div></nav></main></div><div class="py-3 border-top bg-light mt-auto"><div class=container><div class=row><div class=col-sm><ul class=list-unstyled><li>Michele Schimd &copy; 2023</li><li><a class=pr-1 href=mailto:michele.schimd@itiszuccante.edu.it><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" fill="currentcolor" class="bi bi-at" viewBox="0 0 16 16"><path d="M.05 3.555A2 2 0 012 2h12a2 2 0 011.95 1.555L8 8.414.05 3.555zM0 4.697v7.104l5.803-3.558L0 4.697zM6.761 8.83.191 12.857A2 2 0 002 14h12a2 2 0 001.808-1.144l-6.57-4.027L8 9.586l-1.239-.757zm3.436-.586L16 11.801V4.697l-5.803 3.546z"/></svg></a><a class=pr-1 rel=me href=https://github.com/ProfSchimd target=_blank title=ProfSchimd alt=GitHub><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" fill="currentcolor" class="bi bi-github" viewBox="0 0 16 16"><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.012 8.012.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a><a class=pr-1 rel=me href=https://www.linkedin.com/in/michele-schimd-44a85160 target=_blank title=michele-schimd-44a85160 alt=Linkedin><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" fill="currentcolor" class="bi bi-linkedin" viewBox="0 0 16 16"><path d="M0 1.146C0 .513.526.0 1.175.0h13.65C15.474.0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487.0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837.0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822.0-1.359.54-1.359 1.248.0.694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869.0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274.0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54.0 01.016-.025V6.169h-2.4c.03.678.0 7.225.0 7.225h2.4z"/></svg></a><a class=pr-1 rel=me href=https://stackoverflow.com/users/18081937 target=_blank title=18081937><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" fill="currentcolor" class="bi bi-stack-overflow" viewBox="0 0 16 16"><path d="M12.412 14.572V10.29h1.428V16H1v-5.71h1.428v4.282h9.984z"/><path d="M3.857 13.145h7.137v-1.428H3.857v1.428zM10.254.0 9.108.852l4.26 5.727 1.146-.852L10.254.0zm-3.54 3.377 5.484 4.567.913-1.097L7.627 2.28l-.914 1.097zM4.922 6.55l6.47 3.013.603-1.294-6.47-3.013-.603 1.294zm-.925 3.344 6.985 1.469.294-1.398-6.985-1.468-.294 1.397z"/></svg></a></li><li><span style=font-size:small><em>Ultimo aggiornamento: 06/11/2023</em></span></li></ul></div><div class="col-lg text-right"><ul class=list-unstyled><li>Materiale di studio e di esercizio per gli alunni dello Zuccante.</li></ul><div><p><a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/><img style=float:right alt="Creative Commons License" src=https://i.creativecommons.org/l/by-nc/4.0/88x31.png></a></div></p></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js integrity=sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js integrity=sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF crossorigin=anonymous></script></body></html>
<!doctype html><html><head><meta charset=utf-8><title>Gestione dell'I/O &ndash; Michele Schimd
</title><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://cdn.jsdelivr.net/npm/bootswatch@4.5.2/dist/spacelab/bootstrap.min.css rel=stylesheet><link href=https://profschimd.github.io/css/syntax.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css><script src=https://code.jquery.com/jquery-3.4.1.slim.min.js integrity=sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n crossorigin=anonymous></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body class="d-flex flex-column min-vh-100"><header><nav class="p-1 navbar navbar-expand-lg navbar-dark bg-primary"><div class=container><a class=navbar-brand rel=author href=https://profschimd.github.io/>Michele Schimd</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false>Materie</a><ul class=dropdown-menu aria-labelledby=navbarDropdown><li><a href=https://profschimd.github.io/materie/inf/ class=dropdown-item>Informatica</a></li><li><a href=https://profschimd.github.io/materie/sr/ class=dropdown-item>SR</a></li><li><a href=https://profschimd.github.io/materie/tpsit/ class=dropdown-item>TPSIT</a></li><li><a href=https://profschimd.github.io/materie/gpoi/ class=dropdown-item>GPOI</a></li><li><a href=https://profschimd.github.io/materie/ec/ class=dropdown-item>EC</a></li><li><a href=https://profschimd.github.io/materie/python/ class=dropdown-item>Python</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-expanded=false>Classi</a><ul class=dropdown-menu aria-labelledby=navbarDropdown><li><a href=https://profschimd.github.io/classi/3ic/ class=dropdown-item>3IC</a></li><li><a href=https://profschimd.github.io/classi/4ic/ class=dropdown-item>4IC</a></li><li><a href=https://profschimd.github.io/classi/4ia/ class=dropdown-item>5IA</a></li><li><a href=https://profschimd.github.io/classi/5ic/ class=dropdown-item>5IC</a></li><li><a href=https://profschimd.github.io/classi/anni-passati/ class=dropdown-item>Anni precedenti</a></li></ul></li><li class=nav-item><a class=nav-link href=https://profschimd.github.io/about/ role=button><i class="bi bi-info-circle"></i></a></li></ul></div></div></nav></header><div class="p-4 bg-primary" style="background-size:cover;background-position:50%;background-image:linear-gradient(to bottom,rgba(0,0,0,.3) 0%,rgba(0,0,0,.6) 100%),url(https://profschimd.github.io/img/zuccante_it.jpeg)"><div class=container><h1 class="display-4 text-white">Gestione dell'I/O</h1></div></div><div class=bg-light><nav aria-label="breadcrumb mt-0"><div class=container><ol class="breadcrumb py-0 my-1 small"><li class=breadcrumb-item><a href=https://profschimd.github.io/>Home</a></li><li class=breadcrumb-item><a href=https://profschimd.github.io/materie/>Materie</a></li><li class=breadcrumb-item><a href=https://profschimd.github.io/materie/sr/>Sistemi e Reti</a></li><li class=breadcrumb-item><a href=https://profschimd.github.io/materie/sr/3/>Sistemi e Reti - Terzo Anno</a></li><li class=breadcrumb-item><a href=https://profschimd.github.io/materie/sr/3/04-io/>Interrupt e I/O</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://profschimd.github.io/materie/sr/3/04-io/01-io/>I/O</a></li></ol></nav></div><div class="container py-5"><main><div class=row><div class=col-10><aside><nav id=TableOfContents><ul><li><a href=#io-mediante-interrupt>I/O mediante interrupt</a><ul><li><a href=#funzionamento-dellio-mediante-interrupt>Funzionamento dell&rsquo;I/O mediante interrupt</a></li></ul></li><li><a href=#io-mappato-in-memoria>I/O mappato in memoria</a><ul><li><a href=#funzionamento-dellio-mappato-in-memoria>Funzionamento dell&rsquo;I/O mappato in memoria</a></li><li><a href=#arbitraggio-del-bus-di-sistema>Arbitraggio del bus di sistema</a></li></ul></li><li><a href=#gestione-dellio-nelle-architetture-moderne>Gestione dell&rsquo;I/O nelle architetture moderne</a></li></ul></nav></aside></div><div class=col-2></div></div><article><div class=container style=text-align:justify><p>Per completare la descrizione del funzionamento delle <a href=https://profschimd.github.io/materie/sr/3/01-sistemi/01-sistema-elaborazione/#architettura-di-von-neumann>architetture di von Neumann</a>,
è necessario parlare della gestione dell&rsquo;<strong>input</strong>e dell&rsquo;<strong>output</strong>, comunemente indicato <strong>I/O</strong>.</p><p>Il numero ed il tipo di dispositivi di I/O oggi utilizzati è estremamente elevato; alcuni comuni esempi sono:</p><ul><li>Dischi rigidi o memorie SSD</li><li>GPU</li><li>Tastiera, Mouse, Trackpad, Touchscreen, &mldr;</li><li>Schermo/i</li><li>Memorie esterne (USB Pendrive, SD cards, &mldr;)</li><li>Dispositivi di rete (WiFi, Bluetooth, cellulare, &mldr;)</li><li>Stampanti, Scanner, &mldr;</li><li>&mldr;</li></ul><p>Nell&rsquo;architettura di von Neumann, tutti i dispositivi di I/O sono collegati al <em>bus di sistema</em>; solitamente questo collegamento avviene mediante un <strong>controller</strong> che si occupa di gestire il bus e i vari dispositivi connessi (es. controller USB).</p><p>La figura sotto mostra che in un&rsquo;architettura moderna esistono diversi
tipi di dispositivi di I/O e, di conseguenza, diversi ti di <em>controller</em>.
Spesso questi controller corrispondono ad una o più porte fisiche presenti
sulla scheda madre (PCIe, SATA, USB, &mldr;)</p><div class=py-3><div class=mxgraph style="max-width:100%;border:1px solid transparent" data-mxgraph='{"highlight":"#0000ff","nav":true,"resize":true,"toolbar":"zoom layers tags lightbox","edit":"_blank","xml":"<mxfile host=\"app.diagrams.net\" modified=\"2022-02-25T18:27:34.900Z\" agent=\"5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36\" etag=\"4cvJ0woal8oZ4HSeA_vV\" version=\"16.6.4\" type=\"google\"><diagram id=\"0cgwkUNGaXzf5g6J4oWh\" name=\"Page-1\">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</diagram></mxfile>"}'></div><script type=text/javascript src=https://viewer.diagrams.net/js/viewer-static.min.js></script></div><p>La lista di dispositivi presentata sopra, seppure incompleta, mostra
la necessità di un meccanismo di <em>identificazione dei dispositivi di
I/O</em>, questo meccanismo avviene attraverso il concetto di <strong>porta di
I/O</strong>. Ogni porta è numerata 0,1,2,&mldr; e per accedere ad un
dispositivo, è necessario conoscere la porta alla quale è connesso
(a volte chiamata anche <em>indirizzo di I/O</em>).</p><h2 id=io-mediante-interrupt>I/O mediante interrupt</h2><p>Durante la propria esecuzione la CPU può essere interrotta mediante un meccanismo noto com <a href=https://profschimd.github.io/materie/sr/3/04-io/02-interrupt/><em>interrupt</em></a>. Questi interrupt vengono usati dal sistema operativo per <em>schedulare</em> i processi in esecuzione, ma è possibile usarli anche per la gestione dell&rsquo;hardware. L&rsquo;idea è semplice: quando un hardware (ad esempio la tastiera) ha ricevuto dell&rsquo;input e vuole <em>notificare</em> la CPU di questo, genera un interrupt che avvisa la CPU dell&rsquo;avvenuto <em>evento hardware</em>.</p><h3 id=funzionamento-dellio-mediante-interrupt>Funzionamento dell&rsquo;I/O mediante interrupt</h3><p>Vediamo schematicamente come avvengono input e output utilizzando il meccanismo di
interrupt.</p><p>Input</p><ol><li>Il dispositivo di input ha un nuovo dato da far arrivare alla CPU</li><li>Il dispositivo deposita il dato in un proprio registro</li><li>Il dispositivo attiva la linea <code>IRQ</code> (Interrupt ReQuest) ed attende l&rsquo;ok dell CPU</li><li>Ricevuto l&rsquo;ok, il dispositivo invia sul bus dati il contenuto del registro di appoggio</li><li>La CPU copia in un proprio registro il contenuto del bus dati</li><li>Appena possibile, il contenuto del registro viene elaborato dalla CPU</li></ol><p>Output</p><ol><li>La CPU ha un nuovo dato da inviare al dispositivo di output</li><li>La CPU deposita il dato una un proprio registro d&rsquo;appoggio</li><li>La CPU attiva la linea <code>IRQ</code> (Interrupt ReQuest) ed attende l&rsquo;ok del dispositivo</li><li>Ricevuto l&rsquo;ok, la CPU invia sul bus dati il contenuto del registro</li><li>Il dispositivo copia in un proprio registro d&rsquo;appoggio il contenuto del bus dati</li><li>Appena possibile, il contenuto del registro d&rsquo;appoggio viene <em>emesso</em> in output</li></ol><h2 id=io-mappato-in-memoria>I/O mappato in memoria</h2><p>L&rsquo;I/O mediante interrupt ha un notevole svantaggio: ogni volta che un qualsiasi hardware ha dei dati, interrompe la CPU. Ben presto la CPU si troverà interrotta costantemente e sarà costretta a spendere la maggior parte del suo tempo a gestire questi interrupt. Di conseguenza, i programmi saranno rallentati e le performance del sistema caleranno drasticamente.</p><p>Per evitare questo problema si può usare un meccanismo di I/O basato sulla mappatura in memoria dell&rsquo;I/O: <em>memory mapped I/O</em>. L&rsquo;idea consiste nel trasferire ad un indirizzo specifico delle memoria l&rsquo;input proveniente dal dispositivo o l&rsquo;output diretto ad un dispositivo. In questo modo non è il processore che si occupa dell&rsquo;I/O bensì un <strong>I/O controller</strong> al quale, tuttavia, deve essere concesso l&rsquo;accesso al <em>bus di sistema</em> per scrivere in memoria.</p><h3 id=funzionamento-dellio-mappato-in-memoria>Funzionamento dell&rsquo;I/O mappato in memoria</h3><p>Input</p><ol><li>Il dispositivo di input ha nuovi dati in ingresso</li><li>Il dispositivo richiede l&rsquo;accesso al bus</li><li>Il <em>bus arbiter</em> consente al dispositivo di utilizzare il bus</li><li>Il dispositivo, attraverso il bus, memorizza in una zona prestabilita della memoria i dati</li><li>Il dispositivo <em>notifica</em> la CPU che ci sono nuovi dati di input in memoria</li><li>La CPU preleva i nuovi dati</li></ol><p>Output</p><ol><li>La CPU deve scrivere dei dati sul dispositivo di output</li><li>La CPU richiede l&rsquo;accesso al bus</li><li>Il <em>bus arbiter</em> consente alla CPU di utilizzare il bus</li><li>La CPU, attraverso il bus, memorizza in una zona prestabilita della memoria i dati</li><li>La CPU <em>notifica</em> il dispositivo che ci sono nuovi dati di output in memoria</li><li>Il dispositivo manda in output i dati</li></ol><p>Questo tipo di I/O si definisce <em>mappato in memoria</em> proprio perché i dati (di input o
di output) passano attraverso la memoria prima essere letti dalla CPU o scritti in output.
Alcuni dei vantaggi dell&rsquo;I/O mappato in memoria sono</p><ul><li>La CPU può continuare a fare le proprie operazione anche durante l&rsquo;input o l&rsquo;output da e
verso il dispositivo. Questo è importante perché la CPU può essere milioni di volte più
veloce del dispositivo (ad esempio un disco rigido).</li><li>La CPU può generare dati di output più veloce di quanto non sia in grado di scriverli il
dispositivo di output. I dati che sono stati generati dalla CPU, ma non ancora scritti
(proprio perché il dispositivo è lento) possono rimanere temporaneamente nella memoria.</li><li>Il Bus può essere utilizzato in modo più efficiente, ad esempio quando la CPU non ne
ha bisogno per accedere alla memoria, i dispositivi di I/O possono usarlo per le operazioni
di input e output.</li><li>Se per qualche motivo il dispositivo di I/O è occupato con altre operazioni (esempio
altre operazioni di I/O), la CPU non deve aspettare che questo si liberi per leggere
o scrivere i dati (questo è vero soprattutto per le operazioni di scrittura).</li></ul><h3 id=arbitraggio-del-bus-di-sistema>Arbitraggio del bus di sistema</h3><p>Dato che CPU e I/O controller usano lo stesso bus, è necessario un meccanismo di sincronizzazione, detto <strong>arbitraggio</strong>. Lo scopo è evitare che CPU e I/O utilizzino il bus contemporaneamente, se ciò accadesse i due interferirebbero e nessuno riuscirebbe ad effettuare una comunicazione sul bus.</p><p>I metodi di sincronizzazione del bus possono essere suddivisi in due categorie:</p><ol><li><strong>bus sincrono</strong> (<em>synchronous bus</em>) in cui gli accessi sono eseguite seguendo gli <em>eventi</em> scanditi da un <a href=https://profschimd.github.io/materie/sr/3/01-sistemi/04-clock/>clock</a> e</li><li><strong>bus asincrono</strong> (<em>asynchronous bus</em>) in cui gli accessi avvengono mediante sincronizzazioni che non coinvolgono alcun clock.</li></ol><p>Inoltre è possibile suddividere i metodi di sincronizzazione in due altre categorie.</p><ol><li><strong>arbitraggio centralizzato</strong> in cui un hardware apposito (solitamente nel <em>chipset</em> della scheda madre) si occupa di coordinare l&rsquo;accesso al bus dei vari dispositivi connessi.</li><li><strong>arbitraggio distribuito</strong> in cui i vari dispositivi connessi al bus si &ldquo;auto-coordinano&rdquo; per accedere a turno al bus.</li></ol><h4 id=esempio-di-arbitraggio-daisy-chain>Esempio di arbitraggio: <em>daisy chain</em></h4><p>Ci sono diverse tecniche di arbitraggio del bus delle quali ne vediamo una semplice chiamata <em>daisy chain</em>. In questa tecnica tutti i dispositivi (<em>controller</em>) che accedono al bus possono usarlo &ldquo;a turno&rdquo;. Se i controller connessi al bus sono numerati da <code>0</code> a <code>n-1</code>, ci sarà uno <em>slot</em> di tempo per il dispositivo <code>0</code>, uno per il dispositivo <code>1</code>, uno per il dispositivo <code>2</code> fino al dispositivo <code>n-1</code> dopo il quale il turno passa nuovamente a <code>0</code>.</p><p>Questa tecnica molto semplice, tuttavia presenta diversi problemi. Uno è quello che la CPU, che accede spesso al bus, rischia di dover aspettare che finisca un intero giro. Un secondo problema è che il tempo viene dato ad ogni dispositivo (o controller) anche se questo non deve usare il bus. Sarebbe più meglio che il si potesse ``passere&rsquo;&rsquo; ad quei dispositivi che necessitano del bus.</p><h2 id=gestione-dellio-nelle-architetture-moderne>Gestione dell&rsquo;I/O nelle architetture moderne</h2><p>L&rsquo;architettura di von Neumann, proposta agli albori dell&rsquo;informatica, è un valido strumento didattico, ma è oggi superata da architetture più <em>moderne</em>. Facendo riferimento alla figura sotto (fonte Wikipedia), discutiamo brevemente le architetture basaste su <strong>chipset</strong> (in parte installato sulla scheda madre e in parte compreso nel processore). Uno dei compiti del chipset è gestire i vari bus presenti in un&rsquo;architettura moderna.</p><div class=row><div class=col-6><img width=100% src=https://upload.wikimedia.org/wikipedia/commons/b/bd/Motherboard_diagram.svg></div><div class=col-6><p>La prima fondamentale differenza tra l&rsquo;architettura della figura a fianco e
l&rsquo;architettura di von Neumann è la presenza di più di un bus. Inoltre due altri componenti
(oltre a CPU, memoria e I/O) sono connessi ai bus.</p><ul><li><strong>Northbridge</strong> collegato al <strong>Front Side Bus (FSB)</strong> utilizzato per connettere
la CPU con memoria centrale e con i dispositivi ad alta velocità collegati al <em>bus
PCI Express (PCIe)</em>.</li><li><strong>Southbridge</strong> collegato al Northbridge mediante l&rsquo;<strong>Internal Bus (IB)</strong> e dal quale
si diramano diversi altri bus:<ul><li><em>PCI Bus</em> al quale sono collegate le varie periferiche di espansione</li><li><em>Low Pin Count (LPC) Bus</em> a cui sono collegati dispositivi relativamente lenti:
tastiera PS/2, Bios ROM, floppy disk, &mldr;</li><li><em>Serial ATA (SATA) Bus</em> a cui sono collegati dischi e SSD</li><li>USB, Rete, &mldr;</li></ul></li></ul><p>La presenza di una divisione tra il FSB, direttamente collegato alla CPU e i bus a più bassa velocità aveva, agli inizi degli anni 2000, permesso di rendere più efficiente la gestione dell&rsquo;I/O. Con il tempo, tuttavia, anche i dispositivi a &ldquo;bassa velocità&rdquo; hanno iniziato ad essere più efficiente (ad esempi, il passaggio da disco rigido ad SSD) e un chip esterno (il northbridge) non era più in grado di gestire le comunicazioni veloci con la CPU. Per questo motivo le funzioni
del northbridge sono state spostate nello stesso chip della CPU grazie anche all&rsquo;aumento del
numero di transistor che possono essere inseriti in un singolo chip. Oggi, quindi, la divisione
tra northbridge e southbridge è più logica che fisica anche se il southbridge rimane un chip
distinto dalla CPU (cosa non vera per il northbridge). In ogni caso è rimasta la separazione
tra il front side bus a cui la CPU è direttamente collegata e l&rsquo;internal bus a cui sono
collegati i dispositivi di I/O più lenti.</p></div></div></div></article><nav class="mx-5 my-3"><div class=card><h5 class=card-header>Indice di Interrupt e I/O</h5><ul class="list-group list-group-flush"><li class="list-group-item list-group-item-primary"><strong><a href=https://profschimd.github.io/materie/sr/3/04-io/01-io/>> Gestione dell'I/O</a></strong></li><li class=list-group-item><a href=https://profschimd.github.io/materie/sr/3/04-io/02-interrupt/>Interrupt della CPU</a></li></ul><div class=card-footer><a class="btn btn-primary" href=https://profschimd.github.io/materie/sr/3/04-io/>Index</a></div></div></nav></main></div><div class="py-3 border-top bg-light mt-auto"><div class=container><div class=row><div class=col-sm><ul class=list-unstyled><li>Michele Schimd &copy; 2024</li><li><a class=pr-1 href=mailto:michele.schimd@itiszuccante.edu.it><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" fill="currentcolor" class="bi bi-at" viewBox="0 0 16 16"><path d="M.05 3.555A2 2 0 012 2h12a2 2 0 011.95 1.555L8 8.414.05 3.555zM0 4.697v7.104l5.803-3.558L0 4.697zM6.761 8.83.191 12.857A2 2 0 002 14h12a2 2 0 001.808-1.144l-6.57-4.027L8 9.586l-1.239-.757zm3.436-.586L16 11.801V4.697l-5.803 3.546z"/></svg>
</a><a class=pr-1 rel=me href=https://github.com/ProfSchimd target=_blank title=ProfSchimd alt=GitHub><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" fill="currentcolor" class="bi bi-github" viewBox="0 0 16 16"><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.012 8.012.0 0016 8c0-4.42-3.58-8-8-8z"/></svg>
</a><a class=pr-1 rel=me href=https://www.linkedin.com/in/michele-schimd-44a85160 target=_blank title=michele-schimd-44a85160 alt=Linkedin><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" fill="currentcolor" class="bi bi-linkedin" viewBox="0 0 16 16"><path d="M0 1.146C0 .513.526.0 1.175.0h13.65C15.474.0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487.0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837.0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822.0-1.359.54-1.359 1.248.0.694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869.0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274.0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54.0 01.016-.025V6.169h-2.4c.03.678.0 7.225.0 7.225h2.4z"/></svg>
</a><a class=pr-1 rel=me href=https://stackoverflow.com/users/18081937 target=_blank title=18081937><svg xmlns="http://www.w3.org/2000/svg" width="1.5em" fill="currentcolor" class="bi bi-stack-overflow" viewBox="0 0 16 16"><path d="M12.412 14.572V10.29h1.428V16H1v-5.71h1.428v4.282h9.984z"/><path d="M3.857 13.145h7.137v-1.428H3.857v1.428zM10.254.0 9.108.852l4.26 5.727 1.146-.852L10.254.0zm-3.54 3.377 5.484 4.567.913-1.097L7.627 2.28l-.914 1.097zM4.922 6.55l6.47 3.013.603-1.294-6.47-3.013-.603 1.294zm-.925 3.344 6.985 1.469.294-1.398-6.985-1.468-.294 1.397z"/></svg></a></li><li><span style=font-size:small><em>Ultimo aggiornamento: 17/02/2024</em></span></li></ul></div><div class="col-lg text-right"><ul class=list-unstyled><li>Materiale di studio e di esercizio per gli alunni dello Zuccante.</li></ul><div><p><a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/><img style=float:right alt="Creative Commons License" src=https://i.creativecommons.org/l/by-nc/4.0/88x31.png></a></div></p></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js integrity=sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js integrity=sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF crossorigin=anonymous></script></body></html>